  <link href="https://fonts.googleapis.com/css?family=Roboto:400,300,100,500,700,900" rel="stylesheet" type="text/css">
  <link href="<?= base_url() ?>assets/admin/assets/css/icons/icomoon/styles.css" rel="stylesheet" type="text/css">
  <link href="<?= base_url() ?>assets/admin/assets/css/bootstrap.css" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="<?= base_url() ?>assets/admin/assets/css/bootstrapValidator.css" />
  <link href="<?= base_url() ?>assets/admin/assets/css/core.css" rel="stylesheet" type="text/css">
  <link href="<?= base_url() ?>assets/admin/assets/css/components.css" rel="stylesheet" type="text/css">
  <link href="<?= base_url() ?>assets/admin/assets/css/colors.css" rel="stylesheet" type="text/css">
  <link href="<?= base_url() ?>assets/notify/pnotify.custom.min.css" rel="stylesheet" type="text/css">
  <link href="<?= base_url() ?>assets/admin/assets/css/bootstrap-multiselect.css" rel="stylesheet" type="text/css">
  <link rel="stylesheet" type="text/css" href="<?= base_url() ?>assets/dist1/bootstrap-clockpicker.min.css">
  <link href="<?= base_url() ?>assets/admin/assets/css/jquery-ui.css" rel="stylesheet" type="text/css">
  <script type="text/javascript" src="<?= base_url() ?>assets/admin/assets/js/plugins/loaders/pace.min.js"></script>
  <script type="text/javascript" src="<?= base_url() ?>assets/admin/assets/js/core/libraries/jquery.min.js"></script>
  <script type="text/javascript" src="<?= base_url() ?>assets/admin/assets/js/pages/form_select2.js"></script>
  <script type="text/javascript" src="<?= base_url() ?>assets/admin/assets/js/core/libraries/bootstrap.min.js"></script>
  <script type="text/javascript" src="<?= base_url() ?>assets/admin/assets/js/bootstrapValidator.js"></script>
  <script type="text/javascript" src="<?= base_url() ?>assets/admin/assets/js/plugins/loaders/blockui.min.js"></script>
  <script type="text/javascript" src="<?= base_url() ?>assets/admin/assets/js/jquery-ui.js"></script>

  <script type="text/javascript" src="<?= base_url() ?>assets/admin/assets/js/bootstrap-multiselect.min.js"></script>
  <script type="text/javascript" src="<?= base_url() ?>assets/admin/assets/js/plugins/ui/nicescroll.min.js"></script>
  <script type="text/javascript" src="<?= base_url() ?>assets/admin/assets/js/plugins/ui/drilldown.js"></script>
  <script type="text/javascript" src="<?= base_url() ?>assets/notify/pnotify.custom.min.js"></script>
  <script type="text/javascript" src="<?= base_url() ?>assets/admin/assets/js/plugins/tables/datatables/datatables.min.js"></script>
  <script type="text/javascript" src="<?= base_url() ?>assets/admin/assets/js/plugins/tables/datatables/extensions/responsive.min.js"></script>
  <script type="text/javascript" src="<?= base_url() ?>assets/admin/assets/js/plugins/forms/selects/select2.min.js"></script>
  <script type="text/javascript" src="<?= base_url() ?>assets/admin/assets/js/pages/form_layouts.js"></script>
  <script type="text/javascript" src="<?= base_url() ?>assets/admin/assets/js/plugins/forms/styling/uniform.min.js"></script>
  <script type="text/javascript" src="<?= base_url() ?>assets/admin/assets/js/plugins/notifications/pnotify.min.js"></script>
  <script type="text/javascript" src="<?= base_url() ?>assets/admin/assets/js/pages/components_notifications_pnotify.js"></script>
  <script type="text/javascript" src="<?= base_url() ?>assets/admin/assets/js/pages/components_popups.js"></script>
  <script type="text/javascript" src="<?= base_url() ?>assets/admin/assets/js/core/app.js"></script>
  <script type="text/javascript" src="<?= base_url() ?>assets/admin/assets/js/pages/datatables_responsive.js"></script>
  <script type="text/javascript" src="<?= base_url() ?>assets/js/jquery.placeholder.label.js"></script>
  <script type="text/javascript" src="<?= base_url() ?>assets/admin/assets/js/bootstrap-datetimepicker.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-datetimepicker/4.17.47/js/bootstrap-datetimepicker.min.js"></script>
  <script type="text/javascript" src="<?= base_url() ?>assets/admin/assets/js/pages/datatables_basic.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.2/animate.min.css">

  <script src="<?= base_url() ?>assets/admin/assets/js/pages/form_multiselect.js"></script>
  <script src="<?= base_url() ?>assets/admin/assets/js/plugins/forms/selects/bootstrap_multiselect.js"></script>
  <script type="text/javascript" src="<?= base_url() ?>assets/admin/assets/js/plugins/forms/styling/uniform.min.js"></script>

  <script type="text/javascript" src="<?= base_url() ?>assets/admin/assets/js/pages/form_layouts.js"></script>

  <style type="text/css">
    .daterange-single {
      z-index: 100000 !important;
    }

    .modal {
      z-index: 9999;
    }

    .modal-backdrop {
      z-index: 5555;
    }
  </style>

  <style type="text/css">
    .ui-datepicker {
      z-index: 100000 !important;
    }

    .ui-datepicker table td.ui-state-disabled span {
      color: #2d2d2d;
    }

    .ui-datepicker table td.ui-datepicker-today .ui-state-highlight {
      background-color: #2196F3;
      color: #252424;
    }

    .testing {
      z-index: 100000;
    }

    .ui-datepicker .ui-datepicker-title .ui-datepicker-year {
      font-size: 12px;
      color: #333232;
      margin-left: 5px;
    }

    .ui-datepicker .ui-datepicker-prev span,
    .ui-datepicker .ui-datepicker-next span {
      display: none !important;
    }

    .ui-datepicker table td.ui-datepicker-current-day .ui-state-active {
      background-color: #26A69A;
      color: #333;
    }

    .table>tbody>tr>td {
      padding: 7px 15px !important;
    }
  </style>

  <div class="panel panel-flat">
    <div class="panel-body">
      <div class="col-md-12">
        <form class="form-horizontal" id="schedule_form">
          <div class="row">
            <div class="form-group">
              <label class="control-label col-sm-2" for="Youtube">Company Name <span style="color: red;">*</span></label>
              <div class="col-sm-4">
                <select class="select-search" name="customer_id" id="customer_id">
                  <option value="">Select Company</option>
                  <?php
                  foreach ($customer_list as $value) { ?>
                    <option value="<?= $value->customer_id ?>"><?= $value->company_name ?> (<?= $value->contact_person_name1 ?> / <?= $value->phone_no ?>)</option>
                  <?php  } ?>
                </select>
              </div>
              <label class="control-label col-sm-2" for="Youtube">Product Name <span style="color: red;">*</span></label>
              <div class="col-sm-4">
                <select class="select-search" name="product_id" id="product_id">
                  <option value="">Select Product</option>
                  <?php
                  foreach ($product_list as $value1) { ?>
                    <option value="<?= $value1->product_id ?>"><?= $value1->product_name ?></option>
                  <?php  } ?>
                </select>
              </div>
              <!-- </div> -->
            </div>
            <?php
            $user_sess_type = $this->session->user_type;
            if ($this->session->user_type != "SA") {
              $emp_id = $this->session->id;
              $name_emp = $this->session->name;
            } else {
              $emp_id = '';
            }
            ?>
            <input type="hidden" class="form-control" id="user_type_session" value="<?= $user_sess_type ?>" readonly>
            <div class="form-group">
              <label class="control-label col-sm-2" for="Youtube">Employee Name <span style="color: red;">*</span></label>
              <div class="col-sm-4">
                <select class="select-search" name="employee_id" id="employee_id" onchange="getassignedissue()">
                  <option value="">Select Employee</option>
                  <?php
                  foreach ($employee_list as $value2) {
                    $all_emp_id = $value2->id;
                    if ($all_emp_id == $emp_id) { ?>
                      <option value="<?= $value2->id ?>" selected=""><?= $value2->name ?></option>
                    <?php } else { ?>
                      <option value="<?= $value2->id ?>"><?= $value2->name ?></option>
                  <?php }
                  } ?>
                </select>
              </div>
              <label class="control-label col-sm-2" for="email">Schedule Date <span style="color: red;">*</span></label>
              <div class="col-sm-4">
                <input type="text" class="form-control" id="schedule_date" name="schedule_date" placeholder="Enter Schedule Date" onchange="getassignedissue()">
              </div>
            </div>


            <div class="form-group" id="issuelistdetails" style="display: none">
              <label class="control-label col-sm-2" for="Youtube">Assign issue list</label>
              <div class="col-sm-10" id="issue_schedule_list" style="max-height: 110px; overflow: auto;">

              </div>
            </div>
            <div class="form-group">
              <label class="control-label col-sm-2" for="Youtube">Start Time <span style="color: red;">*</span></label>
              <div class="col-sm-4 clockpicker" data-placement="left" data-align="top" data-autoclose="true">
                <input type="text" class="form-control" id="schedule_start_time" name="schedule_start_time" value="" placeholder="Please select start time" onchange="mainInfo1()" onclick="document.getElementById('err3').innerHTML='' ">
                <span id="err3" style="color:red; font-size: 12px;"></span>
              </div>
              <label class="control-label col-sm-2" for="Youtube">End Time <span style="color: red;">*</span></label>
              <div class="col-sm-4 clockpicker" data-placement="left" data-align="top" data-autoclose="true">
                <input type="text" class="form-control" id="schedule_end_time" name="schedule_end_time" value="" placeholder="Please select end time" onchange="mainInfo1()" onclick="document.getElementById('err4').innerHTML='' ">
                <span id="err4" style="color:red; font-size: 12px;"></span>
              </div>
            </div>

            <div class="form-group">
              <label class="control-label col-sm-2" for="Youtube">Set Priority <span style="color: red;">*</span></label>
              <div class="col-sm-10">
                <select class="select-search" name="priority_type" id="priority_type">
                  <option value="">Set Priority Type</option>

                  <option value="Low">Low</option>
                  <option value="Normal">Normal</option>
                  <option value="High">High</option>

                </select>
              </div>
            </div>


            <div class="form-group">
              <label class="control-label col-sm-2" for="Youtube">Schedule Type <span style="color: red;">*</span></label>
              <div class="col-sm-10">
                <select class="select-search" name="schedule_type_id" id="schedule_type_id">
                  <option value="">Select Schedule Type</option>
                  <?php
                  foreach ($schedule_visit_list as $st_value) { ?>
                    <option value="<?= $st_value->id ?>"><?= $st_value->type_name ?></option>
                  <?php  } ?>
                </select>
              </div>
            </div>

            <div class="form-group">
              <label class="control-label col-sm-2" for="email">Comments <span style="color: red;">*</span></label>
              <div class="col-sm-10">
                <textarea class="form-control" rows="2" id="query" name="query" placeholder="Enter Comments" maxlength="500"></textarea>
              </div>
            </div>
          </div>

          <div class="form-group">
            <div class="col-sm-offset-3 col-sm-8">
              <button type="submit" class="btn btn-primary pull-right" id="desktopbutton">
                Add Activity <i class="icon-arrow-right14 position-right"></i>
              </button>
            </div>
            <div class="col-sm-1">
              <div id="preview"></div>
            </div>
          </div>
        </form>
      </div>
    </div>
  </div>
  </div>
  </div>
  </div>

  <script type="text/javascript">
    $(document).ready(function(e) {

      $("#schedule_form").on('submit', (function(e) {
        //e.preventDefault();
        if (e.isDefaultPrevented()) {
          //alert('invalid');
        } else {
          $("#preview").html('<img src="<?= base_url() ?>assets/images/default.gif" style="height:30px;width:30px;" />');
          var formresult = new FormData(this);
          $.ajax({
            url: "<?php echo base_url('admin/Customer/add_schedule'); ?>",
            type: "POST",
            data: new FormData(this),
            contentType: false,
            cache: false,
            processData: false,
            success: function(data) {
              // alert(data);

              $("#preview").hide();
              if (data == 1) {
                $(function() {
                  new PNotify({
                    title: 'Add Schedule',
                    text: 'Schedule Submited Successfully',
                    type: 'success'
                  });
                });

                setTimeout(function() {
                  window.location = "<?php echo base_url('admin/ScheduleManagement/GridList'); ?>";
                }, 1000);
              } else if (data == 2) {
                var notice = new PNotify({
                  title: 'Confirmation',
                  text: '<p>Schedule is already assign on this time. Are sure want to overlap this schedule?</p>',
                  hide: false,
                  type: 'warning',
                  confirm: {
                    confirm: true,
                    buttons: [{
                        text: 'Yes',
                        addClass: 'btn-sm'
                      },
                      {
                        text: 'No',
                        addClass: 'btn-sm'
                      }
                    ]
                  },
                  buttons: {
                    closer: false,
                    sticker: false
                  },
                  history: {
                    history: false
                  }
                })

                // On confirm
                notice.get().on('pnotify.confirm', function() {
                  $.ajax({
                    url: "<?php echo base_url('admin/Customer/add_schedule_overright'); ?>",
                    type: "POST",
                    data: formresult,
                    contentType: false,
                    cache: false,
                    processData: false,
                    success: function(data) {
                      // alert(data);
                      $(function() {
                        new PNotify({
                          title: 'Add Schedule',
                          text: 'Schedule Submited Successfully',
                          type: 'success'
                        });
                      });

                      setTimeout(function() {
                        window.location = "<?php echo base_url('admin/ScheduleManagement/GridList'); ?>";
                      }, 800);


                    },
                    error: function() {
                      alert('Error while request..');
                    }
                  });
                })
                // On cancel
                notice.get().on('pnotify.cancel', function() {
                  // alert('Oh ok. Chicken, I see.');
                });
              }



            },
            error: function() {
              alert('fail');
            }
          });
        }
        return false;

      }));
    });
  </script>
  <script type="text/javascript">
    $(document).ready(function() {
      $('#schedule_form').bootstrapValidator({
        message: 'This value is not valid',
        fields: {


          customer_id: {
            validators: {
              notEmpty: {
                message: 'Please select Customer'
              }
            }
          },

          product_id: {
            validators: {
              notEmpty: {
                message: 'Please select product'
              }
            }
          },

          employee_id: {
            validators: {
              notEmpty: {
                message: 'Please select Employee'
              }
            }
          },

          schedule_date: {
            validators: {
              notEmpty: {
                message: 'Please select Schedule Date'
              }
            }
          },

          query: {
            validators: {
              notEmpty: {
                message: 'Please Enter Query'
              }
            }
          },

          schedule_start_time: {
            validators: {
              notEmpty: {
                message: 'Please select start time'
              }
            }
          },

          schedule_end_time: {
            validators: {
              notEmpty: {
                message: 'Please select end time'
              }
            }
          },

          schedule_type_id: {
            validators: {
              notEmpty: {
                message: 'Please select schedule type'
              }
            }
          },

          emailid: {
            validators: {
              notEmpty: {
                message: 'Email is required.'
              },
              regexp: {
                regexp: '^[^@\\s]+@([^@\\s]+\\.)+[^@\\s]+$',
                message: 'The value is not a valid email address'
              }
            }
          }
        }
      });
    });
  </script>

  <script type="text/javascript">
    $('#schedule_date').change(function() {
      $('#schedule_form').bootstrapValidator('revalidateField', 'schedule_date');
    });

    $('#schedule_start_time').change(function() {
      $('#schedule_form').bootstrapValidator('revalidateField', 'schedule_start_time');
    });

    $('#schedule_end_time').change(function() {
      $('#schedule_form').bootstrapValidator('revalidateField', 'schedule_end_time');
    });
  </script>
  <script language="javascript">
    $(document).ready(function() {
      $("#schedule_date").datepicker({
        dateFormat: "d MM yy",
        minDate: 0
      });

      $("#schedule_date_edit").datepicker({
        dateFormat: "d MM yy",
        minDate: 0
      });
    });
  </script>

  <script type="text/javascript">
    function mainInfo1() {
      var start_date = $('#schedule_date').val();
      var startTime = document.getElementById("schedule_start_time").value;
      var endTime = document.getElementById("schedule_end_time").value;
      var newdate = new Date();
      newdate.setDate(newdate.getDate());
      const monthNames = ["January", "February", "March", "April", "May", "June",
        "July", "August", "September", "October", "November", "December"
      ];
      var dd = newdate.getDate();
      var mm = newdate.getMonth();
      var y = newdate.getFullYear();
      const d = mm;
      var full_month = monthNames[d];
      var someFormattedDate = dd + ' ' + full_month + ' ' + y;
      if ((Date.parse(start_date) == Date.parse(someFormattedDate))) {
        var now = new Date();
        var curr_time = now.getHours() + ':' + now.getMinutes();
        if (startTime >= curr_time) {
          if (startTime >= endTime) {
            $('#desktopbutton').prop('disabled', true);
            new PNotify({
              title: 'Schedule',
              text: 'End time should be greater than Start time',
              type: 'warning'
            });

          } else {
            $('#desktopbutton').prop('disabled', false);
          }
        } else {
          $('#desktopbutton').prop('disabled', true);
          new PNotify({
            title: 'Schedule',
            text: 'Selected timing is less then current time',
            type: 'warning'
          });
        }
      } else {
        var now = new Date();
        var curr_time = now.getHours() + ':' + now.getMinutes();
        if (startTime >= endTime) {
          $('#desktopbutton').prop('disabled', true);
          new PNotify({
            title: 'Schedule',
            text: 'End time should be greater than Start time',
            type: 'warning'
          });

        } else {
          $('#desktopbutton').prop('disabled', false);
        }
      }
    }
  </script>

  <script language="javascript">
    $(document).ready(function() {
      $("#schedule_date").datepicker({
        dateFormat: "d MM yy",
        minDate: 0
      });

      $("#schedule_date_edit").datepicker({
        dateFormat: "d MM yy",
        minDate: 0
      });
    });
  </script>

  <script type="text/javascript">
    $(function() {
      $("#start_date").datepicker({
        changeMonth: true,
        changeYear: true,
        dateFormat: "d M yy"
      });
      $("#end_date").datepicker({
        changeMonth: true,
        changeYear: true,
        dateFormat: "d M yy"
      });
      $("#start_date2").datepicker({
        changeMonth: true,
        changeYear: true,
        dateFormat: "d M yy"
      });
      $("#end_date2").datepicker({
        changeMonth: true,
        changeYear: true,
        dateFormat: "d M yy"
      });
      $("#start_date3").datepicker({
        changeMonth: true,
        changeYear: true,
        dateFormat: "d M yy"
      });
      $("#end_date3").datepicker({
        changeMonth: true,
        changeYear: true,
        dateFormat: "d M yy"
      });
    });
  </script>

  <script>
    function getassignedissue() {
      schedule_date = $('#schedule_date').val();
      employee_id = $('#employee_id').val();
      if (employee_id != '') {
        var datastring = 'schedule_date=' + schedule_date + '&employee_id=' + employee_id;
        $.ajax({
          type: "post",
          url: "<?php echo base_url('admin/Customer/getassignedissue'); ?>",
          cache: false,
          data: datastring,
          success: function(data) {
            // alert(data);
            $('#issuelistdetails').show();
            $('#issue_schedule_list').html(data);
          },
          error: function() {
            alert('Error while request..');
          }
        });
        return false;
      }
    }

    function getassignedissueResch() {
      schedule_date = $('#schedule_date_edit').val();
      emp_id = $('#assign_to_edit').val();
      if (emp_id != '') {
        var datastring = 'schedule_date=' + schedule_date + '&employee_id=' + emp_id;
        $.ajax({
          type: "post",
          url: "<?php echo base_url('admin/Customer/getassignedissue'); ?>",
          cache: false,
          data: datastring,
          success: function(data) {
            // alert(data);
            $('#issuelistdetails_edit').show();
            $('#issue_schedule_list_edit').html(data);
          },
          error: function() {
            alert('Error while request..');
          }
        });
        return false;
      }
    }


    $('#schedule_date').on('dp.change', function(e) {
      var schedule_date = $('#schedule_date').val();
      employee_id = $('#employee_id').val();
      if (employee_id != '') {
        var datastring = 'schedule_date=' + schedule_date + '&employee_id=' + employee_id;
        $.ajax({
          type: "post",
          url: "<?php echo base_url('admin/Customer/getassignedissue'); ?>",
          cache: false,
          data: datastring,
          success: function(data) {
            // alert(data);
            $('#issuelistdetails').show();
            $('#issue_schedule_list').html(data);

          },
          error: function() {
            alert('Error while request..');
          }
        });
        return false;
      }

    });
  </script>